<!DOCTYPE html>
<html lang="zh-cn">

<head>

<title>#2 三角函数与反三角函数</title>
<meta charset="utf-8" />

<link rel="stylesheet" type="text/css" href="css/mathFormat.css" />
<script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-MML-AM_HTMLorMML-full"></script>
<base target="_blank" />

</head>

<body>

<p class="nav">
	<a href="%231.html" style="float: left">&lt;&lt;&lt;</a>
	<a href="content.html">. . .</a>
	<a href="%233.html" style="float: right">&gt;&gt;&gt;</a>
</p>

<h1>附录篇2: 三角函数与反三角函数</h1>

<h2>#2.1 三角函数</h2>

<ul>
<li>和角`{
	( sin (x +- y) = sin x \ cos y +- cos x \ sin y ), 
	( cos (x +- y) = cos x \ cos y &#x2213; sin x \ sin y ), 
	( tan (x +- y) = ( tan x +- tan y )/( 1 &#x2213; tan x \ tan y ))
:}`</li>

<li>倍角`{
	( cos 2x ,= cos^2 x - sin^2 x ),
	( 		 ,= 1 - 2 sin^2 x ),
	( 		 ,= 2 cos^2 x -1 ),
	( sin 2x ,= 2 sin x \ cos x ),
	( cos 3x ,= 4 cos^3 x - 3 cos x ),
	( sin 3x ,= 3 sin x - 4 sin^3 x )
:}`</li>

<li>半角`{
	( cos^2 x = (1 + cos 2x)//2 ),
	( sin^2 x = (1 - cos 2x)//2 ),
	( tan^2 x = (1 - cos 2x)/(1 + cos 2x)),
	( tan x = (sin 2x)/(1 + cos 2x) = (1 - cos 2x)/(sin 2x) ),
	( 1 +- sin 2x = (sin x +- cos x)^2 )
:}`</li>

<li>勾股`{
	( sin^2 x + cos^2 x = 1 ),
	( tan^2 x + 1 = 1 // cos^2 x ),
	( 1 + cot^2 x = 1 // sin^2 x )
:}`</li>

<li>辅助角`{
	( A sin x + B cos x = sqrt(A^2 + B^2) sin ( x + phi), tan phi = B/A ),
	( (1 + C tan x)/(C - tan x) = tan ( x + phi), cot phi = C )
:}`</li>

<li>万能`{
	( tan x = (2t)/(1-t^2), t = tan x/2 ),
	( sin x = (2t)/(1+t^2), ),
	( cos x = (1-t^2)/(1+t^2), )
:}`</li>

<li>和差化积`{
	( sin x +- sin y = 2 sin {: (x +- y)/2 :} cos {: ( x &#x2213; y)/2 :} ),
	( cos x + cos y = 2 cos {: (x+y)/2 :} cos {: (x-y)/2 :} ),
	( cos x - cos y = 2 sin {: (x+y)/2 :} sin {: (x-y)/2 :} ) 
:}`</li>

<li>积化和差`{
	( 2 sin x \ cos y ,= sin (x+y) + sin (x-y) ),
	( 					   ,= sin (y+x) - sin (y-x) ),
	( 2 cos x \ cos y ,= cos (x-y) + cos (x+y) ),
	( 2 sin x \ sin y ,= cos (x-y) - cos (x+y) )
:}`</li>
</ul>

<h2>#2.2 反三角函数</h2>

<p>定义域, 值域:</p>

<p class="formula">`y={
	( arcsin x, if x in [-1,1], y in [-pi/2, pi/2] ),
	( arccos x, if x in [-1,1], y in [0, pi] ),
	( arctan x, if x in (-oo, +oo), y in (-pi/2, pi/2) ),
	( text{arccot} x, if x in (-oo, +oo), y in (0, pi) )
:}`</p>

<p>因为 `arcsin x`, `arccos x`, `arctan x` 都在各自的定义域上单调, 所以对所有定义域中的 `x`,</p>

<p class="formula">`{
	( sin \ arcsin x = x; ),
	( cos \ arccos x = x; ),
	( tan \ arctan x = x. )
:}`</p>

<p>反之, 则不那么优雅:</p>

<p class="formula">`{
	( arcsin \ sin x = (-1)^n (x - n pi), if |x - n pi| le pi/2; ),
	( arccos \ cos x = {
		( x - n pi, if n in text{Even}; ),
		( (n+1) pi - x, if n in text{Odd}; )
	:}, if |x - (n + 1/2)pi| le pi/2; ),
	( arctan \ tan x = x - n pi, if |x - n pi| lt pi/2. )
:}`</p>

<p>相应于一些三角函数公式, 对于反三角函数有如下等式 (对所有定义域中的 `x`):</p>

<p class="formula">`arcsin x + arccos x = pi/2;`</p>

<p class="formula">`arctan x + text(arccot) x = pi/2;`</p>

<p class="formula">`2 arctan e^x - arctan \ text(sh) \ x = pi/2;`</p>

<p class="formula">`arcsin x = text(sgn) x * arccos sqrt (1 - x^2) = arctan {: x/sqrt (1 - x^2) :};`</p>

<p class="formula">`arccos x = {
	( arcsin sqrt (1 - x^2), if x ge 0; ),
	( pi - arcsin sqrt (1 - x^2), if x lt 0. )
:}`
`= {
	( arctan {: sqrt (1 - x^2)/x :}, if x ge 0; ),
	( pi + arctan {: sqrt (1 - x^2)/x :}, if x lt 0. )
:}`</p>

<p class="formula">`arctan x = text(sgn) \ x * arccos {: 1/sqrt (1 + x^2) :} = arcsin {: x/sqrt (1 + x^2) :};`</p>

<p class="formula">`2 arctan sqrt ((a-b)/(a+b)) = arccos {: b/a :}, quad |a| ge |b|;`</p>

<p class="formula">`arccos x = 2 arccos sqrt((1+x)/2) = 2 arcsin sqrt((1-x)/2).`</p>

<p>下面三个式子常用于数学分析:</p>

<p class="formula">`arcsin x - arcsin y = {
	( arcsin(x sqrt(1-y^2) - y sqrt(1-x^2)) if xy ge 0 or x^2 + y^2 le 1; ),
	( pi*text(sgn)(x-y) - arcsin(x sqrt(1-y^2) - y sqrt(1-x^2)) if else. )
:}`</p>

<p class="formula">`arccos x - arccos y = arccos(xy + sqrt((1-x^2)(1-y^2)) )* text(sgn)(y-x).`</p>

<p class="formula">`arctan x - arctan y = {
	( arctan {: (x-y)/(1+xy) :} if xy ge -1; ),
	( arctan {: (x-y)/(1+xy) + pi * text(sgn)(x-y) if xy lt -1. :} )
:}`</p>

<p><b>注#2.2</b> 考虑如下的证明思路 (以 `arcsin x + arccos x = pi/2` 的证明为例):</p>

<p>原式成立当且仅当</p>

<p class="formula">`arcsin x = pi/2 - arccos x,`</p>

<p>注意到上式两边之差的绝对值不超过 `2 pi`, 所以上式成立当且仅当</p>

<p class="formula">`sin \ arcsin x = sin (pi/2 - arccos x),`</p>

<p>即 `x = cos \ arccos x,` 这显然成立.</p>

<h2>#2.3 双曲三角函数</h2>

<ul>
<li>和角`{
	( text{sh} (x +- y) = text{sh} x \ text{ch} y +- text{sh} y \ text{ch} x ),
	( text{ch} (x +- y) = text{ch} x \ text{ch} y +- text{sh} x \ text{sh} y ),
	( text{th} (x +- y) = (text{th} x +- text{th} y)/(1 +- text{th} x text{th} y). )
:}`</li>

<li>倍角 `{
	( text{sh} 2x 	,= 2 text{sh} x \ text{ch} x; ),
	( text{ch} 2x 	,= text{ch}^2x + text{sh}^2x; ),
	( 				,= 2 text{ch}^2x - 1; ),
	( 				,= 2\;\text{sh}^2x + 1. )
:}`</li>

<li>勾股 `{
	( text{ch}^2x ,= text{sh}^2x + 1; ),
	( 1 ,= text{th}^2x + 1 // text{ch}^2x; ),
	( 1 // text{th}^2x ,= 1 + 1 // text{sh}^2x. )
:}`</li>
</ul>

<h2>#2.4 反双曲三角函数</h2>

<ul>
<li>`{
	( text{arsh}x = ln (x + sqrt(x^2+1)), if x in RR; ),
	( text{arch}x = ln (x + sqrt(x^2-1)), if x ge 1; ),
	( text{arth}x = 1/2 ln ((1+x)/(1-x)), if -1 lt x lt 1. )
:}`</li>
</ul>

<h2>#2.5 De Moivre's Theorem</h2>

<p class="formula">`(cos x + i \ sin x)^n = cos nx + i \ sin nx, quad AA n in NN.`</p>

<p>对 n 作归纳即可证明. 上式左边展开, 分别取实部和虚部就得到: 对任意正整数 n,</p>

<p class="formula">
`cos nx = ((n), (0)) cos^n x - ((n), (2)) cos^(n-2) x \ sin^2 x + cdots`
		`+ (-1)^(epsilon/2) ((n),(epsilon)) cos^(n-epsilon) x \ sin^epsilon x,`</p>

<p class="formula">
`sin nx = ((n), (1)) cos^(n-1)x \ sin x - ((n), (3)) cos^(n-3)x \ sin^3 x + cdots`
		`+ (-1)^((theta-1)/20) ((n), (theta)) cos^(n-theta)x \ sin^theta x.`</p>

<p>其中 `epsilon` 是不超过 `n` 的最大偶数, `theta` 是不超过 `n` 的最大奇数.</p>

<h2>#2.6 Euler's Formula</h2>

<p class="formula">`e^(ix) = cos x + i \ sin x, quad AA x in CC.`</p>

<p>从而</p> 
<p class="formula">`cos x = (e^(ix) + e^(-ix))/2,` `sin x = (e^(ix) - e^(-ix))/{2i}.`</p>

<p class="formula">`arccos x = -i \ ln (x + i sqrt(1-x^2)),` `arcsin x = -i \ ln (sqrt(1-x^2) + ix),` `arctan x = -i \ ln {:(1 + ix)/sqrt(1+x^2):}. `</p>

<p><b>注#2.6</b> 比如, 设 `y = arccos x,` 则 `e^{iy} = cos y + i \ sin y = x + i sqrt(1-x^2),` 于是 `y = -i ln (x + i sqrt(1-x^2)).`</p>

<h2>#2.7 杂例</h2>

<p><b>#2.7.1</b> 计算 `sum_(k=1)^n cos kx` 和 `sum_(k=1)^n sin kx.`</p>

<p>利用积化和差与和差化积:</p>

<p class="formula">`{:
	( 2 sin{:x/2:} sum_(k=1)^n cos kx ,= sum_(k=1)^n [sin(k+1/2)x - sin(k-1/2)x] ),
	( 								  ,= sin(n+1/2)x - sin{:x/2:}.),
	( 								  ,= 2cos {:((n+1)x)/2:} \ sin {:(nx)/2:})
:}`</p>
<p>故</p>
<p class="formula">`sum_(k=1)^n cos kx = ( cos {:((n+1)x)/2:} \ sin {:(nx)/2:} ) / sin{:x/2:}. quad (#2-3-1)`</p>

<p>`n gt 1` 时, 将 `x = (2 pi)/n` 代入上式,</p>
<p class="formula">`sum_(k=1)^n cos {:(2k pi)/n:} = (cos{:((n+1)pi)/n:} \ sin pi) / sin {:pi/n:} = 0.`</p>

<p>类似地,</p>
<p class="formula">`sum_(k=1)^n sin kx = (sin {:((n+1)x)/2:} \ sin {:(nx)/2:}) / sin {:x/2:}, (#2-3-2)`</p>

<p>且 `n gt 1` 时, 代入 `x = (2 pi)/n` 得到:</p>
<p class="formula">`sum_(k=0)^n sin {:(2k pi)/n:} = (sin {:((n+1)pi)/n:} \ sin pi) / sin {:pi/n:} = 0.`</p>

<p>这两个结果的几何意义是, 向量组 `vec e_k = ( cos {:(2k pi)/n:}, sin {:(2k pi)/n:} ), quad k = 1, 2, cdots, n.` 中所有向量之和为零.</p>

<p>最后, 显然 `x` 是 `2 pi` 的整数倍时, 有:</p>
<p class="formula">`sum_(k=0)^n cos kx = n,` `sum_(k=0)^n sin kx = 0.`</p>

<p><b>#2.7.2</b> 计算 `sin 20^@ * sin40^@ * sin80^@.`</p>

<p>记 `x = 10^@,` 注意到 `sin 8x = cos x,` 利用积化和差, 上式即</p>
<p class="formula">`{:
	(   ,1/2 [cos(4-2)x - cos(4+2)x] cos x ),
	( = ,1/2 (cos 2x - 1/2) cos x ),
	( = ,1/2 cos 2x \ cos x - 1/4 cos x ),
	( = ,1/4 [cos(2+1)x + cos(2-1)x] - 1/4 cos x ),
	( = ,(sqrt 3)/8. )
:}`</p>

<p><b>#2.7.3</b> 计算 `1/(2sin 10^@) ( 3/(sin^2 40^@) - 1/(cos^2 40^@) ).`</p>

<p>同样设 `x = 10^@.` 由 #2.2 知
`1/2 = sin 3x = 3cos^2 x \ sin x - sin^3 x = 3 sin x - 4 sin^3 x.`</p>

<p>消去 `sin^3 x` 后, 得到 `8 cos^2 x \ sin x = 2sin x + 1.`</p>

<p>于是原式等于</p>
<p class="formula">`{:
(   ,1/(2 sin x) ( 6/(1 - cos 8x) - 2/(1 + cos 8x) ) ),
( = ,1/sin x ( (3(1+sin x) - (1-sin x)) / ( 1-sin^2 x) ) ),
( = ,(2(2sin x + 1)) / (sin x \ cos^2 x) ),
( = ,16.)
:}`</p>

<a href="%231.html" style="float: left">&lt;&lt;&lt;</a>
<a href="%233.html" style="float: right">&gt;&gt;&gt;</a>

</body>

<script src="js/randomColor.js"></script>
<script src="js/setBgcolor.js"></script>

</html>
