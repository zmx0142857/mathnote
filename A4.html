<!DOCTYPE html>
<html lang="zh-cn">

<head>

<title>A4 疑难积分</title>
<meta charset="utf-8" />

<link rel="stylesheet" type="text/css" href="css/math.css" />
<script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-MML-AM_HTMLorMML-full"></script>
<script src="js/asciimathml.js"></script>

</head>

<body>

<div id="nav">
	<a href="A3.html" id="prev">&lt;&lt;&lt;</a>
	<a href="content.html" target="_blank">· · ·</a>
	<a href="A5.html" id="next">&gt;&gt;&gt;</a>
</div>

<h1>分析篇4: 疑难积分</h1>

<h2>关键公式</h2>
<ul>
<li>
	<div class="formula">
		`int_a^b f(x) text(d)x
		stackrel(x=a+b-t)(=====) int_a^b f(a+b-t)text(d)t`.
	</div>
</li>
<li>如果 `f(x)` 有对称轴 `x = u`, 即 `f(x) = f(2u-x)`,
	那么
	<div class="formula">
		`int_(u-a)^u f(x) text(d)x = int_u^(u+a) f(x) text(d)x`.
	</div>
</li>
<li>如果 `f(x)` 有对称中心 `(u, v)`, 即 `f(x) = 2v - f(2u-x)`,
	那么
	<div class="formula">
		`int_(u-a)^u f(x) text(d)x + int_u^(u+a) f(x) text(d)x = 2va`.
	</div>
</li>
</ul>

<h2>`I = int_0^(pi/2) ln sin x text(d)x`.</h2>

<p class="solve">
	令 `x = pi/2 - t`,
	则 `I = int_0^(pi/2) ln cos t text(d)t`.
	注意到 `[0, pi]` 是 `sin x` 的对称区间,
	所以又有 `int_0^pi ln sin x = 2I`.
	于是
	<div class="formula">`
{:(			2I
,		=	int_0^(pi/2) (ln sin x + ln cos x) text(d)x
),(,	=	1/2 int_0^(pi/2) (ln sin 2x - ln 2) text(d)(2x)
),(,	=	1/2 int_0^pi ln sin x text(d)x - (pi ln2)/2
),(,	=	I - (pi ln2)/2.
):}`</div>

	故 `I = -(pi ln2)/2`.
</p>

<h2>`I = int (text(d)x) / sqrt((a+x)(b-x))`.</h2>

<p class="solve">
	令 `t = sqrt((a+x)/(b-x))`,
	则 `x = (bt^2-a) / (1+t^2)`,
	`text(d)x = (2(a+b)t) / (1+t^2)^2 text(d)t`.
	于是

	<div class="formula">`
{:(			I
,		=	int (2(a+b)t text(d)t)/( t|b-(bt^2-a)/(1+t^2)| (1+t^2)^2 )
),(,	=	2 text(sgn)(a+b) int (text(d)t) / (1+t^2)
),(,	=	2 text(sgn)(a+b) * arctan sqrt((a+x)/(b-x)) + C.
):}`</div>
</p>

<h2>`I = int_h^(R sin phi)
		arccos{: (x cot phi) / sqrt(R^2-x^2) :} text(d)x`,
	`0 lt h lt R sin phi`, `phi in [0, pi/2)`.
</h2>

<p class="solve">
	令 `u = (x cot phi) / sqrt(R^2-x^2)`,
	则 `x = (Ru) / sqrt(u^2 + cot^2 phi)`.
	记 `r = sqrt(R^2 - h^2)`, 于是

	<div class="formula">
		`I = [(Ru arccos u) / sqrt(u^2+cot^2 phi)]_((h cot phi)//r)^1
		+ R/2 int_((h cot phi)//r)^1 (text(d)(u^2))
		/ sqrt( (cot^2 phi + u^2)(1-u^2) )`.
	</div>

	由上题,
	<div class="formula">`
{:(			I
,		=	- h arccos{: (h cot phi)/r :}
			+ R[ arctan sqrt((cot^2 phi + u^2) / (1-u^2)) ]
			_((h cot phi)//r)^1
),(,	=	- h arccos{: (h cot phi)/r :}
			+ R(pi/2-arctan{:(R cot phi) / sqrt(r^2-h^2 cot^2 phi):})
),(,	=	R arccos{: (R cos phi)/r :} - h arccos{: (h cot phi)/r :}.
):}`</div>
</p>

<h2>`I = int sqrt((a^2x-b^2) / (1-x)) (text(d)x)/x`.</h2>

<p class="solve">
	令 `t = sqrt((a^2x-b^2)/(1-x))`,
	则 `x = (b^2+t^2)/(a^2+t^2)`,
	`text(d)x = (2t(a^2-b^2)) / (a^2+t^2)^2 text(d)t`.
	于是

	<div class="formula">`
{:(			I
,		=	int t * (a^2+t^2) / (b^2+t^2)
			* (2t(a^2-b^2)) / (a^2+t^2)^2 text(d)t
),(,	=	2 int ( a^2/(a^2 + t^2) - b^2 / (b^2 + t^2) ) text(d)t
),(,	=	2 ( a arctan{:t/a:} - b arctan{:t/b:} ) + C.
):}`</div>

	再将 `t` 代回, 即得最终结果.
</p>

<h2>`I = int_(h_1)^(r_2) arccos{: (h_2)/sqrt(R^2-x^2) :} text(d)x`,
	其中 `R = sqrt(h_1^2 + r_1^2) = sqrt(h_2^2 + r_2^2)`.
</h2>

<p class="solve">
	令 `u = h_2/sqrt(R^2-x^2)`,
	则 `x = sqrt( R^2 - (h_2/u)^2 )`.
	于是

	<div class="formula">`
{:(			I
,		=	[ sqrt( R^2 - (h_2/u)^2 ) arccos u ]_(h_2//r_1)^1
			+ int_(h_2//r_1)^1 sqrt( R^2 - (h_2/u)^2 )
			(text(d)u) / sqrt(1-u^2)
),(,	=	- h_1 arccos {:h_2/r_1:}
			+ 1/2 int_(h_2//r_1)^1 sqrt( (R^2u^2 - h_2^2) / (1-u^2) )
			( text(d)(u^2) ) / u^2.
):}`</div>

	由上题知, 上式第二项等于
	<div class="formula">`
{:(,		[R arctan{:1/R:} sqrt((R^2u^2 - h_2^2)/(1-u^2))
			- h_2 arctan{:1/h_2:}
			sqrt((R^2u^2 - h_2^2)/(1-u^2)) ]_(h_2//r_1)^1
),(		 =,	pi/2 (R-h_2)
			- (R arctan{:(h_1 h_2)/(R sqrt(r_1^2 - h_2^2)):}
			- h_2 arctan{:h_1/sqrt(r_1^2 - h_2^2):} )
),(		 =,	R arccos{:(h_1 h_2)/(r_1 r_2):} - h_2 arccos{:h_1/r_2:}.
):}`</div>

	故
	<div class="formula">
		` I = R arccos{:(h_1 h_2)/(r_1 r_2):}
		- h_1 arccos{:h_2/r_1:}
		- h_2 arccos{:h_1/r_2:}`.
	</div>
</p>

<h2>`int sqrt(a^2 - x^2) text(d)x`.</h2>

<p class="solve">
	原式 `= 1/2 int sqrt(a^2 - x^2) text(d)x
	+ 1/2 int sqrt(a^2 - x^2) text(d)x`.

	将第一项拆开 (分子有理化) , 并对第二项分部积分, 原式等于

	<div class="formula">`
{:(,		( 1/2 int (a^2 text(d)x) / sqrt(a^2-x^2)
			- 1/2 int (x^2 text(d)x) / sqrt(a^2-x^2) ) 
			+ ( 1/2 x sqrt(a^2 - x^2)
			+ 1/2 int (x^2 text(d)x)/sqrt(a^2 - x^2) )
),(		=,	a^2/2 arcsin{:x/a:} + x/2 sqrt(a^2 - x^2) + C.
):}`</div>

	这个积分的几何意义是,
	“从四分之一圆中减去半个弓形,
	余下的面积等于一个扇形的面积加一个直角三角形的面积”.

	类似地可以算出
	<div class="formula">
		` int sqrt(a^2+x^2) text(d)x
		= a^2/2 ln (x + sqrt(a^2+x^2)) + x/2 sqrt(a^2+x^2) + C`.
	</div>
</p>

<h2>`I_n = int_0^(pi/2) sin^n x text(d)x
		 = int_0^(pi/2) cos^n x text(d)x`.
</h2>

<p class="solve">
	原式等于
	<div class="formula">`
{:(,		int_0^(pi/2) cos^(n-1) x text(d)(sin x)
),(		=,	[cos^(n-1) x * sin x]_0^(pi/2)
			- int_0^(pi/2) sin x text(d)(cos^(n-1) x)
),(		=,	0 + (n-1)int_0^(pi/2) sin^2 x * cos^(n-2) x text(d)x
),(		=,	(n-1) ( int_0^(pi/2) cos^(n-2) x text(d)x
			- int_0^(pi/2) cos^n x text(d)x )
),(		=,	(n-1)( I_(n-2) - I_n ).
):}`</div>

	于是
	<div class="formula">
		`I_n = (n-1)/n I_(n-2)`.
	</div>

	易求得 `I_0 = pi/2`, `I_1 = 1`. 所以

	<div class="formula">`I_n = {
		( (n-1)/n * (n-3)/(n-2) cdots 2/3 * 1, if n in Odd; ),
		( (n-1)/n * (n-3)/(n-2) cdots 1/2 * pi/2, if n in Even. )
	:}`</div>

<h2>`I_n = int (text(d)x) / (x^2 + a)^n`.</h2>

<p class="solve">
	<div class="formula">`
{:(			I_(n-1)
,		=	int (text(d)x) / (x^2 + a)^(n-1)
),(,	=	x/(x^2+a)^(n-1) - int x text(d)(x^2+a)^(1-n)
),(,	=	x/(x^2+a)^(n-1) + 2(n-1) int (x^2+a-a)/(x^2+a)^n text(d)x
),(,	=	x/(x^2+a)^(n-1) + (2n-2)( I_(n-1) - aI_n ).
):}`</div>

	故 `(2n-2)aI_n = x/(x^2+a)^(n-1) + (2n-3)I_(n-1)`.
</p>

<h2>`int (text(d)x) / (ax^2 + b)^2`.</h2>

<p class="solve">
	在上题的结果中取 n = 2 得

	<div class="formula">
		` (2b)/a int (text(d)x) / (x^2 + b/a)^2
		= x/(x^2 + b/a) + int (text(d)x) / (x^2 + b/a)`.
	</div>

	于是
	<div class="formula">
		` 2b int (text(d)x)/(ax^2 + b)^2
		= x/(ax^2 + b) + int (text(d)x) / (ax^2 + b)`.
	</div>
</p>

<h2>`int x^2 sin^3 x text(d)x`.</h2>

<p class="solve">
	原式等于
	<div class="formula">`
{:(,		int x^2 sin x text(d)x - int x^2 sin x cos^2 x text(d)x
),(,	=	- int x^2 text(d)(cos x) + 1/3 int x^2 text(d)(cos^3 x)
),(,	=	- x^2 cos x + 2 int x cos x text(d)x
			+ 1/3 x^2 cos^3 x - 2/3 int x cos^3 x text(d)x
),(,	=	- x^2 cos x + 2 int x cos x text(d)x + 1/3 x^2 cos^3 x
			- 2/3 int x cos x text(d)x + 2/3 int x cos x sin^2 x text(d)x
),(,	=	- x^2 cos x + 4/3 x sin x + 4/3 cos x + 1/3 x^2 cos^3 x
			+ 2/9 int x text(d)(sin^3 x)
),(,	=	- x^2 cos x + 4/3 x sin x + 4/3 cos x + 1/3 x^2 cos^3 x
			+ 2/9 x sin^3 x - 2/9 int sin^3 x text(d)x.
):}`</div>

	因为
		`  int sin^3 x text(d)x = int (cos^2 x - 1) text(d)(cos x)`
		`= 1/3 cos^3 x - cos x + C`,

	所以原式等于
	<div class="formula">
		`- x^2 cos x + 4/3 x sin x + 14/9 cos x + 1/3 x^2 cos^3 x
		 + 2/9 x sin^3 x - 2/27 cos^3 x + C`.
	</div>
</p>

<h2>`int sqrt(1+x^4) / (x^3) text(d)x`.</h2>

<p class="solve">
	依然是分子有理化.
	令 `t = x^2`, 则 `text(d)t = 2x text(d)x`.
	原式等于

	<div class="formula">
		` 1/2 int sqrt(1 + t^2)/t^2 text(d)t
		= 1/2 int 1/(t^2 sqrt(1+t^2)) text(d)t
		  + 1/2 int 1/sqrt(1+t^2) text(d)t`.
	</div>

	令 `t = sinh u`, 则 `text(d)t = cosh u text(d)u`,
	从而第一项等于

	<div class="formula">
		` 1/2 int (text(d)u)/(sinh^2 u)
		= - cosh u/(2 sinh u) + C_1 = -sqrt(1+t^2) / (2t) + C_1`.
	</div>

	第二项积分的结果是 `1/2 ln (t + sqrt(1+t^2)) + C_2`.

	所以原式等于
	<div class="formula">
		`1/2 ln (x^2 + sqrt(1+x^4)) - sqrt(1+x^4) / (2x^2) + C`.
	</div>
</p>

<h2>`I = int e^(ax) cos bx text(d)x`.</h2>

<p class="prove">
	<div class="formula">`
{:(			(a^2+b^2)I
,		=	a^2 int e^(ax) cos bx text(d)x
			+ b^2 int e^(ax) cos bx text(d)x
),(,	=	a int cos bx text(d)(e^(ax))
			+ b int e^(ax) text(d)(sin bx)
),(,	=	a e^(ax) cos bx + ab int e^(ax) sin bx text(d)x
			+ b e^(ax) sin bx - ab int e^(ax) sin bx text(d)x
),(,	=	a e^(ax) cos bx + b e^(ax) sin bx + C_0.
):}`</div>

	所以
	<div class="formula">
		`I = e^(ax)/(a^2+b^2) (a cos bx + b sin bx) + C`.
	</div>
</p>

<h2>这些不定积分没有初等的表达式:</h2>
<div class="block">
	<li>`int e^(-x^2) text(d)x`,</li>
	<li>`int sin x/x text(d)x`,</li>
	<li>`int e^x/x text(d)x`,</li>
	<li>`int (text(d)x)/ln x`,</li>
	<li>`int (text(d)x)/sqrt(1 + x^4)`,</li>
	<li>`int sqrt(1-a^2 cos^2 theta) text(d) theta`.</li>
</div>

<p>	虽然原函数不初等, 但可以积出 `int_(-oo)^(+oo) e^(-x^2) text(d)x`.
	利用重积分 `int int_D e^(-x^2-y^2) text(d)x text(d)y`
	(D是圆心在原点, 半径为R的圆域)
	` = int int_D rho e^(-rho^2) text(d)rho text(d)theta`
	` = int_0^(2pi)text(d)theta int_0^R rho e^(-rho^2)text(d)rho`
	` = pi(1 - e^(-R^2))`.
	
	另一方面, `int int_(D_1) e^(-x^2-y^2) text(d)x text(d)y`
	(`D_1` 是矩形域 `[-R, R]xx[-R, R]`)
	` = int_(-R)^R e^(-x^2) text(d)x int_(-R)^R e^(-y^2) text(d)y`
	` = (int_(-R)^R e^(-x^2) text(d)x)^2`.
	令 `R to +oo`, 得 `int_(-oo)^(+oo) e^(-x^2) text(d)x = sqrt(pi)`.
</p>

</body>

<script src="js/random-color.js"></script>
<script src="js/set-bgcolor.js"></script>
<script src="js/num.js"></script>

</html>
